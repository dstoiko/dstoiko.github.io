<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>Moona: Part II - HAX :: dstoiko personal blog</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
<meta name="description" content="This is the second article from a series on the story of Moona. Check out the other ones here Moona: Start-up Story Series.
HAX Before flying to Shenzhen, actually as soon as we got accepted into the program, I watched a documentary that had been released by Wired just a few months before. It was starring Bunnie Huang, a brilliant electronics engineer who, while still a grad student at MIT, became the first person to hack the Xbox firmware back in December 2001."/>
<meta name="keywords" content=""/>
<meta name="robots" content="noodp"/>
<link rel="canonical" href="/posts/moona-2-hax/" />


<link rel="stylesheet" href="/assets/style.css">

  <link rel="stylesheet" href="/assets/green.css">






<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/img/apple-touch-icon-144-precomposed.png">

<link rel="shortcut icon" href="/img/favicon/green.png">



<meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="Moona: Part II - HAX :: dstoiko personal blog — " />
<meta name="twitter:description" content="This is the second article from a series on the story of Moona. Check out the other ones here Moona: Start-up Story Series.
HAX Before flying to Shenzhen, actually as soon as we got accepted into the program, I watched a documentary that had been released by Wired just a few months before. It was starring Bunnie Huang, a brilliant electronics engineer who, while still a grad student at MIT, became the first person to hack the Xbox firmware back in December 2001." />
<meta name="twitter:site" content="/" />
<meta name="twitter:creator" content="dstoiko" />
<meta name="twitter:image" content="">


<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="Moona: Part II - HAX :: dstoiko personal blog — ">
<meta property="og:description" content="This is the second article from a series on the story of Moona. Check out the other ones here Moona: Start-up Story Series.
HAX Before flying to Shenzhen, actually as soon as we got accepted into the program, I watched a documentary that had been released by Wired just a few months before. It was starring Bunnie Huang, a brilliant electronics engineer who, while still a grad student at MIT, became the first person to hack the Xbox firmware back in December 2001." />
<meta property="og:url" content="/posts/moona-2-hax/" />
<meta property="og:site_name" content="Moona: Part II - HAX" />
<meta property="og:image" content="">
<meta property="og:image:width" content="2048">
<meta property="og:image:height" content="1024">

<meta property="article:published_time" content="2019-11-23 00:00:00 &#43;0000 UTC" />











</head>
<body class="">


<div class="container">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="/">
  <div class="logo">
    dstoiko&#39;s blog
  </div>
</a>

    </div>
    <div class="menu-trigger">menu</div>
  </div>
  
    <nav class="menu">
  <ul class="menu__inner menu__inner--desktop">
    
      
        
          <li><a href="/about">About</a></li>
        
      
        
          <li><a href="/posts">Posts</a></li>
        
      
        
          <li><a href="/showcase">Showcase</a></li>
        
      
      
    

    
  </ul>

  <ul class="menu__inner menu__inner--mobile">
    
      
        <li><a href="/about">About</a></li>
      
    
      
        <li><a href="/posts">Posts</a></li>
      
    
      
        <li><a href="/showcase">Showcase</a></li>
      
    
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<div class="post">
  <h1 class="post-title">
    <a href="/posts/moona-2-hax/">Moona: Part II - HAX</a></h1>
  <div class="post-meta">
      
    <span class="post-date">
      2019-11-23
    </span>
    
    
    <span class="post-author">::
      dstoiko
    </span>
    
    
    <span class="post-reading-time">::
      12-min read
    </span>
    
  </div>

  
  <span class="post-tags">
    
    #<a href="/tags/moona/">moona</a>&nbsp;
    
    #<a href="/tags/shenzhen/">shenzhen</a>&nbsp;
    
    #<a href="/tags/hardware/">hardware</a>&nbsp;
    
  </span>
  

  

  <div class="post-content">
    

<p><em>This is the second article from a series on the story of Moona. Check out the other ones here <a href="/posts/moona-0-series">Moona: Start-up Story Series</a>.</em></p>

<h1 id="hax">HAX</h1>

<p>Before flying to Shenzhen, actually as soon as we got accepted into the program, I watched a documentary that had been released by Wired just a few months before. It was starring Bunnie Huang, a brilliant electronics engineer who, while still a grad student at MIT, became the first person to hack the Xbox firmware back in December 2001. He&rsquo;s now an electronics consultant and actually works with HAX teams to advise them on all things related to electrical engineering, hardware product development and manufacturing. Here&rsquo;s the documentary which I highly recommend:</p>


<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/SGJ5cZnoodY" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>


<p>Arriving at HAX was quite an experience. It was the very first time we had an office space dedicated to hardware start-ups, and shared by such awesome projects that ranged from robotics to biotech. The first thing we did was take a few office spots in the big open space&hellip;</p>


  <figure class="left" >
    <img src="./media/IMG_2698.png"  alt="HAX Open Space"   />
    
      <figcaption class="center" >Big open space with around 120 seats. Alumni were allowed to occupy roughly half of the spots</figcaption>
    
  </figure>



<p>Then we visited the workshop, where we were given our own toolbox-cart, with brand-new mechanical and electrical engineering tools for prototyping. There was a mechanical side with milling, laser-cutting, 3D-printing and all the shared tools we needed to quickly get a prototype to work. The other side was dedicated to electrical engineering, with soldering stations, multimeters, oscilloscopes and all kinds of cables and accessories, again to make prototyping quick and easy.</p>


  <figure class="left" >
    <img src="./media/IMG_2701.png"  alt="HAX Workshop"   />
    
      <figcaption class="center" >The workshop! At that time it was about 200 sq. m., so we had to share benches with other start-ups on a first-come, first-served basis</figcaption>
    
  </figure>



<p>Our objective for the upcoming 4 months was to go from a basic works-like prototype to a works-like-looks-like prototype, which meant the following had to happen:</p>

<ul>
<li>Product design</li>
<li>Mechanical (3D CAD) design</li>
<li>Components sourcing and testing</li>
<li>Sensor data acquisition and processing</li>
<li>PCB redesign</li>
<li>Firmware rewrite</li>
<li>App and server development</li>
<li>UX tests and iterations</li>
</ul>

<p>By the end of the program we had to be ready to make a crowdfunding campaign to start the marketing and sales efforts.</p>

<h1 id="the-shenzhen-team">The Shenzhen Team</h1>

<p>We arrived in Shenzhen just after Chinese New Year in February 2017. One of the first things I noticed when we arrived (even in HK where we landed) was how many skyscrapers there were, even for apartment buildings. We hit the road to Shenzhen to go to the HAX offices and get a feel for the city as soon as we could. We were staying at an airbnb which was actually a &ldquo;homemade&rdquo; hotel as the owners had just bought a few apartments in a building on the ~12th floor (out of ~30, standard there) and set up a makeshift counter in one of them&hellip;</p>


  <figure class="left" >
    <img src="./media/IMG_2673.png"  alt="Shenzhen Skyscrapers"   />
    
      <figcaption class="center" >This is what Shenzhen looks like. Pretty cool huh?</figcaption>
    
  </figure>



<p>One of the first recommended experiences is the local food. My prior experiences of Chinese food were mostly at those Chinese &ldquo;catering&rdquo; places in Paris, most of which are - I learned that later - originally founded by immigrants from the Wenzhou area, near Shanghai. Food is usually pre-cooked and heated up in a microwave upon order. I hadn&rsquo;t tried any of the authentic foods China had to offer. So my tastebuds (and digestive system) were in completely new territory.</p>


  <figure class="left" >
    <img src="./media/IMG_2720.png"  alt="Green Tea Restaurant"   />
    
      <figcaption class="center" >Enjoying Green Tea restaurant with other HAX teams</figcaption>
    
  </figure>



<p>Once we had settled, it was time for some hard work&hellip;</p>

<p>We assembled the team for HAX a few weeks before flying to Shenzhen. Each of us had multiple key roles within the team:</p>

<ul>
<li><strong>Coline</strong>: product/go-to-market strategy, hardware product development &amp; prototyping, investor relations, pitching</li>
<li><strong>Me</strong>: tech/product strategy, electronics and firmware prototyping, software development, pitching</li>
<li><strong>Serge</strong>: hardware prototyping, components sourcing and testing (thermal, sensors), PCB design, CAD design</li>
<li><strong>Pierre</strong>: hardware prototyping, components sourcing and testing (hydraulics, sensors), CAD design</li>
<li><strong>Edgar</strong>: software development (app, server, firmware), working remotely from France</li>
<li><strong>Marion</strong>: marketing, design, crowdfunding campaign planning and management</li>
</ul>

<h2 id="product-design">Product design</h2>

<p>First, we had a kick-off meeting with the lead designer, Noel, a very talented and experienced industrial designer from Ireland working with the HAX teams. We took our existing moodboards and early design concepts, as well as the features we envisioned in our final product, and put them all on the table in order to generate ideas and produce a new design for our looks-like prototype. At that time, we had already made a looks-like version of the device for CES, which had a very strict size constraint.</p>

<p>Noel helped us define the main lines of the industrial design, and the key design attributes, like the colors, the wood finish, the buttons and screen placement, and all the UX considerations which impact the final design, such as the location of the pillow pad, the length of the tubing, as well as the materials to use.</p>

<h2 id="mechanical-3d-cad-design">Mechanical (3D CAD) design</h2>

<p>Once we had that design and components sourced and tested, we made a 1:1 scale version using rudimentary materials such as flexible plastic sheets, plexi tanks, and our new PCBA in the making. That was quick, and we had to move forward as the clock was ticking and our first big deadline, &ldquo;+60&rdquo; (60 days after the beginning of the program), was fast approaching.</p>

<p>Tyler, a Chinese mechanical engineer equipped with super-fast professional CAD software skills, helped us actually turn the 3D design concepts we had defined with Noel into a 3D-printable CAD design in which all of our mechanical and electronics components fit snugly.</p>

<p>After a few weeks of prototyping, we realized the size constraints we had in mind were way too strict if we were to actually make it work! So we decided to scale the product back up to find a middle ground between our &ldquo;works-like&rdquo; and our &ldquo;looks-like&rdquo; prototypes.</p>

<p>We had to make roughly 5 iterations of the whole hardware &ldquo;casing&rdquo; design in order to get everything to fit properly and even then, it was pretty fragile. Each time, there would be a problem either with waterproofing, or tolerances, or peripherals we had to change and which required additional design revisions.</p>

<p>This constant iteration with UX tests helped us shape the product experience.</p>

<h2 id="components-sourcing-and-testing">Components sourcing and testing</h2>

<p>As soon as we started prototyping in China, we were in contact with suppliers, either in the electronics markets of HuaQiangBei (华强北), the central avenue where HAX was located - all we literally had to do was to go downstairs from the office and find parts - or around Shenzhen in the industrial areas of Bao&rsquo;an, Dongguan and Guangzhou.</p>

<p>We relied heavily on the <a href="https://taobao.com" target="_blank">Taobao</a> and <a href="https://1688.com" target="_blank">Alibaba</a> websites for finding components and establishing contacts with factories. The first impression we got from these websites is just &ldquo;wow&rdquo;: you can find so many things on there for any purpose, it&rsquo;s also mind-blowing that most of the parts we ordered off the shelf or as factory samples arrived to the HAX office in less than 3 business days. Compare that to the 2 weeks it took on average to get a part while in France, and it just makes so much sense to be there for the prototyping and product development phase.</p>

<p>We tested around 10 different pumps, 15 heating / cooling elements, and 30 different combinations of materials for the pillow pad, comparing their performance and reliability, before we made our final choices. At that time we created our very first BOM (bill of materials), which was still ridiculously high as we were buying parts at very low volume.</p>

<h2 id="sensor-data-acquisition-and-processing">Sensor data acquisition and processing</h2>

<p>In order to make our prototype fully work like the idea we had of our final product, we had to add the following sensors:</p>

<ul>
<li>A heatsink temperature sensor, to make thermoregulation more efficient and less noisy by regulating fan speed</li>
<li>An accelerometer, to estimate sleep quality through the user&rsquo;s movements during the night</li>
<li>An ambient temperature and humidity sensor, to gather more data about the user&rsquo;s sleep environment</li>
</ul>

<p>We bought one sensor module (breakout board) of each model we could find easily for prototying: the ones we tested were not necessarily the optimal sensors for our needs, but all of them could connect directly to an Arduino development kit (we were using the Arduino Mega board at the time), or equivalent, without having to design a custom circuit for it. Another criterion was that the sensor module should have an easily pluggable C/C++ software library so that we could get results from the sensor without having to write the interfaces from the datasheet. So we had a test setup and could make decisions quickly. The key final considerations we had were whether the sensor works reliably and whether it was easy to integrate it into our prototype - with our final form factor mechanical constraints in mind.</p>

<h2 id="pcb-redesign">PCB redesign</h2>

<p>The PCB (Printed Circuit Board) we had when we arrived at HAX had several issues that we needed to deal with:</p>

<ul>
<li>It was too big to fit into our final size constraint</li>
<li>It didn&rsquo;t integrate all the functions we needed for the final product</li>
</ul>

<p>So after around 30 days of testing and prototyping, we set out to redesign the whole PCB.</p>

<p>We started with a new block diagram in order to layout all the basic functions our prototype needed to have. Then we integrated the key components (actuators and sensors) we had selected through initial testing. We also changed the architecture to include a new microcontroller unit (MCU), the ESP32, which integrated BLE and Wi-Fi connectivity.</p>

<p>In order to enable prototyping, we made some decisions which, in retrospect, we probably should have done differently. We used the development kit (ESP32-Devkit-C) of the MCU that we plugged onto female headers on our PCB. The idea was that we could use it independently to prototype with new sensors and actuators on a breadboard, then plug it back on our PCB, or even swap MCU modules at will. The main problem with this approach is that it made the actual physical interfaces more fragile - connectors of any kind are the main weaknesses of an electrical circuit - which caused some headaches while debugging, and posed additional risks. We also added &ldquo;general purpose&rdquo; i2c and SPI circuits in order to swap out sensor breakout modules as we tested them, but each one has its own recommended circuits and it caused some headaches and we ended up adding external circuits around the main PCB, which was clumsy. We could have just gone with a simple set of headers for flashing the firmware quickly, decided on sensors and made more revisions of the PCB design, which are quick and cheap to make in Shenzhen anyway, to test things out, but we ended up making the PCB a bit too &ldquo;crowded&rdquo;&hellip;</p>

<h2 id="firmware-rewrite">Firmware rewrite</h2>

<p>Our firmware when we joined HAX consisted of a set of Arduino sketches that did everything the very basic product needed to do:</p>

<ul>
<li>Regulate temperature using a feedback loop between temperature sensors, a heat pump and a water pump</li>
<li>Handle user interaction through buttons and a simple LCD screen</li>
<li>Set alarm time and temperature settings each time the user launches a night</li>
</ul>

<p>Up until that point, it was &ldquo;good enough&rdquo; to get people who were interested to test the prototype and get useful UX feedback from them. But at some point, the good ideas suggested through these tests started piling up. We also needed a &ldquo;looks-like&rdquo; prototype we could actually sell to backers / customers and show to investors, so we had to include additional features that would push our product to the next level and make it attractive enough that people would want to buy it and support us on a crowdfunding campaign, without going into &ldquo;feature creep&rdquo;.</p>

<p>In order to achieve that, we:</p>

<ul>
<li>separated each component into its own class for cleaner code and to be able to quickly swap out components if we needed to change them</li>
<li>designed a finite state machine to handle all possible states the product can be in (connecting, settings, night&hellip;)</li>
<li>enabled simple wireless connection with the app</li>
<li>integrated new sensors and actuators, external memory using SD card storage, and a new LED matrix display to replace the LCD screen</li>
</ul>

<h2 id="app-and-server-development">App and server development</h2>

<p>Before HAX, we had a prototype app made at the very beginning of the project, and a few functional mock-ups of the app, made with <a href="https://marvelapp.com" target="_blank">Marvel</a>. That way we could easily test the core features we had in mind for our MVP app and focus on UX first, before doing any major coding.</p>

<p>Once we had iterated enough on UX design ideas using mock-ups, we started planning for software development.</p>

<p>For the tech choices, we spent a few days figuring out which option was best for our needs:</p>

<p>For the app, we needed a simple development workflow and ideally develop once for both platforms as we had limited resources. After considering several options, we settled on React Native (which had already been used for the initial prototype of the app), which meant developing once using JavaScript for an app compiled in both Android and iOS.</p>

<p>For the server, we needed a simple and reliable infrastructure, to handle app interactions (user account, settings, data) through an HTTPS API. We settled on the Go language, as Edgar was already familiar with it and it seemed like a good choice for building a simple and reliable server, with a solid open-source community and proper tools.</p>

<h2 id="ux-tests-and-iterations">UX tests and iterations</h2>

<p>Throughout the program, we set out to build our prototypes in very short cycles, which allowed us to test as much as we could, either on ourselves or on volunteers amongst other HAX teams. We tried to keep a pace of at least one short UX testing session per week, where we would ask people from the office to test each time a different part of the product and give us feedback. We also organized full-night tests at our apartment building, which was useful even though the logistics were cumbersome with fragile prototypes. We had a few water leaks along the way, but it gave us priceless insights that guided development.</p>

<h2 id="key-learnings">Key Learnings</h2>

<p>Here are some key takeaways we got from our HAX experience, which are good to keep in mind and that I wish I knew before starting&hellip;</p>

<ol>
<li><strong>Keep it simple</strong>: we tended to underestimate complexity when starting new projects with an optimistic mindset, so always simplifying any design or technical decision saves a lot of bandwidth and headaches down the road</li>
<li><strong>Think it through</strong>: we tended to rush towards a &ldquo;workable&rdquo; solution too often in the development process, and that lead us to waste time when we needed to do revisions or adapt our prototype, so spending one extra day thinking things through is usually well worth it, so it&rsquo;s useful to go against urgency and pressure to gain efficiency</li>
<li><strong>Test everything you can</strong>: although we did test a lot of things, there&rsquo;s always something that slips through the net if you&rsquo;re not careful enough, so going through a simple but exhaustive test checklist avoids bad assumptions that mess everything up</li>
</ol>

  </div>
  
  <div class="pagination">
    <div class="pagination__title">
      <span
        class="pagination__title-h">Read other posts</span>
      <hr />
    </div>
    <div class="pagination__buttons">
      
      
      <span class="button next">
        <a href="/posts/moona-0-series/">
          <span class="button__text">Moona: Start-up Story Series</span>
          <span class="button__icon">→</span>
        </a>
      </span>
      
    </div>
  </div>
  

  

</div>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2020 Powered by <a href="http://gohugo.io">Hugo</a></span>
    
        <span>:: Theme made by <a href="https://twitter.com/panr">panr</a></span>
      </div>
  </div>
</footer>

<script src="/assets/main.js"></script>
<script src="/assets/prism.js"></script>





  
</div>

</body>
</html>
